<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Code Generator - Free & Secure</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free Universal QR and Barcode Generator. Create standard QR Codes and Code 128 barcodes instantly and securely using only client-side logic.">
    <meta name="keywords" content="QR code generator, barcode generator, free, secure, online tool, Code 128">
    
    <!-- Canonical Link for Promotion -->
    <link rel="canonical" href="https://mgpwagle.github.io/code-generator/">

    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for better aesthetics */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }
        /* Custom styles for contrast and modern look */
        .card-shadow {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05), 0 5px 15px rgba(0, 0, 0, 0.03);
        }
        .code-output {
             /* Soft inner shadow for the area where the code is displayed */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
        }
    </style>

    <!-- Google Analytics (GA4) Global Site Tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0EYLBGXZ2J"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0EYLBGXZ2J');
    </script>

    <!-- SEO: JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Universal Code Generator",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Web",
      "description": "A free, secure, and client-side tool to generate QR codes and Barcodes.",
      "inLanguage": "en-US",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>

    <!-- Load React and Babel for JSX compilation -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- MANDATORY: Load External Code Generation Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs@gh-pages/qrcode.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;

    // --- ANALYTICS UTILITY ---

    const trackEvent = (eventName, params = {}) => {
        if (typeof gtag === 'function') {
          gtag('event', eventName, params);
        } else {
          // Fallback log for environments where gtag isn't ready
          console.log(`Analytics event tracked: ${eventName}`, params);
        }
    };


    // --- CODE GENERATOR COMPONENTS ---

    const BarcodeGenerator = ({ value }) => {
      const svgRef = useRef(null);
      const [error, setError] = useState(null);

      const renderBarcode = useCallback(() => {
        if (typeof JsBarcode === 'undefined') {
            setError("ERROR: JsBarcode library is not loaded. Cannot generate Barcode.");
            return;
        }
        setError(null);

        if (svgRef.current && value.trim()) {
          // Barcodes (Code 128) have a practical character limit of about 80 characters for standard scanning.
          if (value.trim().length > 100) {
             setError("Barcode data too long. Code 128 is best for short data (e.g., up to 100 characters).");
             return;
          }

          svgRef.current.innerHTML = '';
          
          try {
            JsBarcode(svgRef.current, value.trim(), {
              format: "CODE128",
              displayValue: true,
              text: value,
              textAlign: "center",
              textPosition: "bottom",
              flat: true,
              height: 80,
              width: 2,
            });
          } catch (e) {
            setError(`Barcode generation failed: ${e.message}`);
          }
        } else if (svgRef.current) {
            svgRef.current.innerHTML = '';
        }
      }, [value]);

      useEffect(() => {
        renderBarcode();
      }, [value, renderBarcode]);

      return (
        <div className="flex justify-center p-6 bg-gray-50 rounded-xl mt-4 w-full code-output border border-gray-200">
          {error ? (
            <p className="text-red-500 font-bold text-center">{error}</p>
          ) : value.trim() ? (
            <svg ref={svgRef} className="max-w-full h-auto"></svg>
          ) : (
            <p className="text-gray-500 italic">Enter text or a URL and click 'Generate' to create a Barcode.</p>
          )}
        </div>
      );
    };

    const QrGenerator = ({ value }) => {
      const qrRef = useRef(null);
      const [error, setError] = useState(null);

      const renderQrCode = useCallback(() => {
        if (typeof QRCode === 'undefined') {
            setError("ERROR: QRCode.js library is not loaded. Cannot generate QR Code.");
            return;
        }
        setError(null);
        
        // QR Code data limit warning/error (Max bytes ~2953, Max Alphanumeric ~4296)
        if (value.trim().length > 3000) {
             setError("Data limit exceeded. QR Codes are limited to roughly 3,000 characters (max 4,296 alphanumeric). Use a URL for large data.");
             return;
        }

        if (qrRef.current && value.trim()) {
          qrRef.current.innerHTML = '';

          try {
            new QRCode(qrRef.current, {
              text: value.trim(),
              width: 256,
              height: 256,
              colorDark : "#1f2937", /* Darker gray for contrast */
              colorLight : "#ffffff",
              correctLevel : QRCode.CorrectLevel.H
            });
          } catch (e) {
            setError(`QR Code generation failed: ${e.message}`);
          }
        } else if (qrRef.current) {
            qrRef.current.innerHTML = '';
        }
      }, [value]);

      useEffect(() => {
        renderQrCode();
      }, [value, renderQrCode]);

      return (
        <div className="flex justify-center p-6 bg-gray-50 rounded-xl mt-4 w-full code-output border border-gray-200">
          {error ? (
            <p className="text-red-500 font-bold text-center">{error}</p>
          ) : value.trim() ? (
            <div ref={qrRef} className="p-2 bg-white rounded-lg shadow-inner">
              {/* QR Code will be drawn here by QRCode.js */}
            </div>
          ) : (
            <p className="text-gray-500 italic">Enter text or a URL and click 'Generate' to create a QR Code.</p>
          )}
        </div>
      );
    };
    
    /**
     * Main application component.
     */
    const App = () => {
      const defaultInput = 'https://www.google.com';
      const [inputValue, setInputValue] = useState(defaultInput);
      const [codeValue, setCodeValue] = useState(defaultInput);
      const [activeTab, setActiveTab] = useState('QR'); // Default to QR
      const inputRef = useRef(null);
      

      // --- HANDLERS ---

      const handleGenerate = () => {
        setCodeValue(inputValue);
        // Analytics tracking
        trackEvent('code_generated', {
            code_type: activeTab,
            data_length: inputValue.length,
            method: 'manual_input'
        });
      };

      const handleTabClick = (tab) => {
        setActiveTab(tab);
        setCodeValue(inputValue); // Always regenerate on tab switch
        
        // Analytics tracking
        trackEvent('tab_switch', { new_tab: tab });
        
        // Focus on input 
        if (inputRef.current) {
            inputRef.current.focus();
        }
      };

      const TabButton = ({ tabName }) => (
        <button
          onClick={() => handleTabClick(tabName)}
          className={`py-3 px-5 sm:px-8 text-lg font-semibold transition-all duration-300 ease-in-out whitespace-nowrap border-b-2
            ${activeTab === tabName
              ? 'border-indigo-600 text-indigo-700'
              : 'border-transparent text-gray-500 hover:border-indigo-300'
            }
          `}
        >
          {tabName}
        </button>
      );

      return (
        <div className="min-h-screen bg-slate-50 flex items-start sm:items-center justify-center p-4 sm:p-8 font-sans">
          {/* Main Card is reduced to max-w-md for a smaller, cleaner look */}
          <div className="w-full max-w-md bg-white rounded-xl card-shadow p-6 sm:p-8 border border-gray-100">

            {/* Header and Menu Tabs */}
            <header className="mb-6 mt-2">
              <h1 className="text-3xl font-extrabold text-indigo-700 mb-4 text-center">
                Code Generator
              </h1>
              <div className="flex justify-center border-b border-gray-200">
                <TabButton tabName="QR" />
                <TabButton tabName="Barcode" />
                {/* Removed: Read Code Tab */}
              </div>
            </header>
            
            <React.Fragment>
                {/* Manual Input Area (Generator Focus) */}
                <section className="mb-6">
                    <label htmlFor="code-input" className="block text-sm font-semibold text-gray-700 mb-2">
                        Data to Encode:
                    </label>
                    <input
                        type="text"
                        ref={inputRef}
                        id="code-input"
                        value={inputValue}
                        onChange={(e) => setInputValue(e.target.value)}
                        placeholder={`Enter text or a URL for ${activeTab} Code generation...`}
                        className="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-gray-800"
                        aria-label="Code input data"
                    />
                    <div className="flex w-full mt-4">
                        <button
                            onClick={handleGenerate}
                            className="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-200 shadow-lg shadow-teal-500/30 transform hover:scale-[1.01] active:scale-[0.99] text-lg"
                        >
                            Generate {activeTab} Code
                        </button>
                    </div>

                    <p className="mt-4 text-xs text-gray-500 text-center">
                        <span className="font-semibold">{activeTab} Codes</span> are best for {activeTab === 'QR' ? 'URLs or short text strings.' : 'short, alphanumeric data (up to ~100 chars).'}
                    </p>
                </section>

                {/* Code Output Area */}
                <section className="flex flex-col items-center min-h-[300px] pt-4">
                    <h2 className="text-lg font-bold text-gray-800 mb-2">
                        Generated {activeTab}
                    </h2>
                    {/* Conditional rendering based on the active tab */}
                    {activeTab === 'QR' && <QrGenerator value={codeValue} />}
                    {activeTab === 'Barcode' && <BarcodeGenerator value={codeValue} />}
                </section>
            </React.Fragment>

            {/* Footer for link promotion */}
            <footer className="mt-6 pt-4 border-t border-gray-100 text-center text-xs text-gray-400">
                Project hosted at: 
                <a 
                    href="https://mgpwagle.github.io/code-generator/" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="text-indigo-500 hover:text-indigo-700 font-medium ml-1 transition-colors"
                >
                    mgpwagle.github.io/code-generator/
                </a>
            </footer>

          </div>
        </div>
      );
    };

    // Render the React application
    if (typeof ReactDOM !== 'undefined' && typeof document !== 'undefined') {
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    }
    </script>
</body>
</html>
